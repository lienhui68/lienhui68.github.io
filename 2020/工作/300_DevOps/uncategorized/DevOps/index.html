<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/assets/1.png?v=2.0.1" type="image/png" sizes="16x16"><link rel="icon" href="/assets/1.png?v=2.0.1" type="image/png" sizes="32x32"><meta name="description" content="原文：https:&#x2F;&#x2F;library.prof.wang&#x2F;handbook&#x2F;h&#x2F;hdbk-MWnS99ThmLVDi7U5mVFrB9                      DevOps简介        DevOps 一词的来自于 Development 和 Operations 的组合，突出重视软件开发人员和运维人员的沟通合作，通过自动化流程来使得软件构建、测试、发布更加快捷、频繁和可靠">
<meta property="og:type" content="article">
<meta property="og:title" content="DevOps">
<meta property="og:url" content="http://lienhui68.gitee.io/2020/%E5%B7%A5%E4%BD%9C/300_DevOps/uncategorized/DevOps/index.html">
<meta property="og:site_name" content="lienhui68の博客">
<meta property="og:description" content="原文：https:&#x2F;&#x2F;library.prof.wang&#x2F;handbook&#x2F;h&#x2F;hdbk-MWnS99ThmLVDi7U5mVFrB9                      DevOps简介        DevOps 一词的来自于 Development 和 Operations 的组合，突出重视软件开发人员和运维人员的沟通合作，通过自动化流程来使得软件构建、测试、发布更加快捷、频繁和可靠">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913195701.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913200114.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913200414.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913201803.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202454.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202655.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202822.png">
<meta property="og:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202828.png">
<meta property="article:published_time" content="2020-09-16T16:22:39.283Z">
<meta property="article:modified_time" content="2020-09-16T16:22:39.299Z">
<meta property="article:author" content="lienhui68">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/lienhui68/picStore/raw/master/null/20200913195701.png"><meta name="keywords" content="lienhui68, lienhui68の博客"><meta name="description" content=""><title>DevOps | lienhui68の博客</title><link ref="canonical" href="http://lienhui68.gitee.io/2020/%E5%B7%A5%E4%BD%9C/300_DevOps/uncategorized/DevOps/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.0.1"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: undefined,
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"ocean","wordWrap":false},
  reward: true,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: {"colWidth":"220px","gapX":"10px"},
  lazyload: true,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 4.2.1"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-flask"></i></span><span class="header-nav-menu-item__text">实验室</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/photo/"><span class="header-nav-submenu-item__icon"><i class="fas fa-images"></i></span><span class="header-nav-submenu-item__text">相册</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/music/"><span class="header-nav-submenu-item__icon"><i class="fas fa-music"></i></span><span class="header-nav-submenu-item__text">音乐</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">关于</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">搜索</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">DevOps</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2020-09-17</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2020-09-17</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">3.4k</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="far fa-clock"></i></span><span class="post-meta-item__info">阅读时长</span><span class="post-meta-item__value">18分</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">阅读次数</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><blockquote>
<p>原文：<span class="exturl"><a class="exturl__link"   href="https://library.prof.wang/handbook/h/hdbk-MWnS99ThmLVDi7U5mVFrB9"  target="_blank" rel="noopener">https://library.prof.wang/handbook/h/hdbk-MWnS99ThmLVDi7U5mVFrB9</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>

        <h1 id="devops简介"   >
          <a href="#devops简介" class="heading-link"><i class="fas fa-link"></i></a>DevOps简介</h1>
      
<p>DevOps 一词的来自于 Development 和 Operations 的组合，突出重视软件开发人员和运维人员的沟通合作，<span style='color:LimeGreen;background:背景颜色;font-size:文字大小;font-weight:'>通过自动化流程来使得软件构建、测试、发布更加快捷、频繁和可靠</span>。DevOps 其实包含了三个部分：开发、测试和运维。换句话 DevOps 希望做到的是<span style='color:red;background:背景颜色;font-size:文字大小;font-weight:'>软件产品交付过程中IT工具链的打通</span>，使得各个团队减少时间损耗，更加高效地协同工作。</p>
<a id="more"></a>

        <h1 id="devops工具链"   >
          <a href="#devops工具链" class="heading-link"><i class="fas fa-link"></i></a>DevOps工具链</h1>
      
<ul>
<li>项目管理（PM）：Jira</li>
<li>代码管理：GitLab</li>
<li>持续集成（CI）：GitLab CI</li>
<li>镜像仓库：VMware Harbor</li>
<li>容器：Docker</li>
<li>容器平台： Rancher</li>
<li>镜像扫描：Clairctl</li>
<li>编排：Kubernetes</li>
<li>服务注册与发现：etcd</li>
<li>脚本语言：python</li>
<li>日志管理：EFK</li>
<li>系统监控：prometheus</li>
<li>Web服务器：Nginx</li>
<li>数据库：MySQL redis</li>
</ul>

        <h1 id="devops架构"   >
          <a href="#devops架构" class="heading-link"><i class="fas fa-link"></i></a>DevOps架构</h1>
      
<blockquote>
<p>DevOps 流水线（工具链）</p>
</blockquote>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913195701.png"  alt="" />
      </p>

        <h1 id="devops环境部署"   >
          <a href="#devops环境部署" class="heading-link"><i class="fas fa-link"></i></a>Devops环境部署</h1>
      
<blockquote>
<p><strong>备注：</strong> 按照 DevOps 流水线顺序部署<br />
先部署，后续实战中简介如何把流水线打通，实现通过平台一键发布功能</p>
</blockquote>

        <h2 id="安装jira项目管理"   >
          <a href="#安装jira项目管理" class="heading-link"><i class="fas fa-link"></i></a>安装JIRA（项目管理）</h2>
      
<p><strong>JIRA简介</strong>：</p>
<p>JIRA 是 Atlassian 公司出品的项目与事务跟踪工具，被广泛应用于缺陷跟踪、客户服务、需求收集、流程审批、任务跟踪、项目跟踪和敏捷管理等工作领域。 JIRA 中配置灵活、功能全面、部署简单、扩展丰富，其超过150项特性得到了全球115个国家超过19,000家客户的认可。</p>
<p><strong>JIRA安装</strong>：</p>
<p>安装配置过程请参考：<span class="exturl"><a class="exturl__link"   href="https://www.atlassian.com/software/Jira"  target="_blank" rel="noopener">官方网站</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="安装-gitlab代码管理"   >
          <a href="#安装-gitlab代码管理" class="heading-link"><i class="fas fa-link"></i></a>安装 GitLab(代码管理)</h2>
      
<p><strong>GitLab 简介</strong>:</p>
<p>Git 是目前世界上最先进的分布式版本控制系统（没有之一）， 而 GitLab 是基于 git 协议开发 Web 控制台，Git 命令能操作的大部分功能， 都可以通过gitLab web控制台操作。</p>
<p><strong>GitLab 安装</strong>：</p>
<p>请参考：<span class="exturl"><a class="exturl__link"   href="https://library.prof.wang/handbook_html/h02-linux/GitLab/index.html"  target="_blank" rel="noopener">GitLab 安装详情</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="安装-docker容器服务"   >
          <a href="#安装-docker容器服务" class="heading-link"><i class="fas fa-link"></i></a>安装 Docker（容器服务）</h2>
      
<p><strong>Docker 简介</strong>：</p>
<p>Docker 是通过内核虚拟化工作（namespaces及cgroups等）来提供容器的资源隔离与安全保障等。由于Docker通过操作系统层的虚拟化实现隔离，所以Docker容器在运行时，不需要类似虚拟机（VM）额外的操作系统开销，提高资源利用率。 三大理念：Build（构建）、Ship（运输）、Run（运行） Docker 组成：Docker Client、Docker Server</p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913200114.png"  alt="" />
      </p>
<p><strong>Docker 安装</strong>：</p>
<p>请参考: <span class="exturl"><a class="exturl__link"   href="https://library.prof.wang/handbook_html/h02-linux/Docker/index.html"  target="_blank" rel="noopener">Docker安装详情</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="安装-rancher容器调度"   >
          <a href="#安装-rancher容器调度" class="heading-link"><i class="fas fa-link"></i></a>安装 Rancher（容器调度）</h2>
      
<p><strong>Rancher 简介</strong>：</p>
<p>Rancher是一个开源的企业级容器管理平台。通过Rancher，企业再也不必自己使用一系列的开源软件去从头搭建容器服务平台。Rancher提供了在生产环境中使用的管理Docker和Kubernetes的全栈化容器部署与管理平台。 Rancher由以下四个部分组成： 基础设施编排、容器编排与调度、应用商店、企业级权限管理 下图展示了Rancher的主要组件和功能：</p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913200414.png"  alt="" />
      </p>
<p><strong>Rancher 安装</strong>：</p>
<p>请参考: <span class="exturl"><a class="exturl__link"   href="https://library.prof.wang/handbook_html/h02-linux/Rancher/index.html"  target="_blank" rel="noopener">Rancher安装部署</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="安装-harbor镜像仓库"   >
          <a href="#安装-harbor镜像仓库" class="heading-link"><i class="fas fa-link"></i></a>安装 Harbor（镜像仓库）</h2>
      
<p><strong>Harbor 简介</strong>：</p>
<p>Harbor是一个用于存储和分发Docker镜像的企业级Registry服务器，通过添加一些企业必需的功能特性，例如安全、标识和管理等，扩展了开源Docker Distribution。 Harbor支持安装在多个Registry节点的镜像资源复制，镜像全部保存在私有Registry中， 确保数据和知识产权在公司内部网络中管控。另外，Harbor也提供了高级的安全特性，诸如用户管理，访问控制和活动审计等。</p>
<p><strong>Harbor 安装</strong>：</p>
<p>请参考:<span class="exturl"><a class="exturl__link"   href="https://library.prof.wang/handbook_html/h02-linux/Harbor/index.html"  target="_blank" rel="noopener">安装详情</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="安装-clair镜像扫描"   >
          <a href="#安装-clair镜像扫描" class="heading-link"><i class="fas fa-link"></i></a>安装 Clair（镜像扫描）</h2>
      
<p><strong>Clair 简介</strong>：</p>
<p>Clair 的功能通过 Restful API 实现，但是每个 API 参数很多，而且上传镜像时还有很多复杂的处理。所以 CoreOS 为我们提供了 Clairctl 这款工具。Clairctl 是一个 Clair 客户端， 让用户可以通过简单的命令就能实现镜像的上传、扫描、输出报告等等。</p>
<p><strong>Clair 安装</strong>：</p>
<p>请参考：<span class="exturl"><a class="exturl__link"   href="https://blog.csdn.net/m0_37552052/article/details/78907296"  target="_blank" rel="noopener">安装详情</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<hr />

        <h1 id="持续集成-持续交付-持续部署"   >
          <a href="#持续集成-持续交付-持续部署" class="heading-link"><i class="fas fa-link"></i></a>持续集成、持续交付、持续部署</h1>
      

        <h2 id="指导思想"   >
          <a href="#指导思想" class="heading-link"><i class="fas fa-link"></i></a>指导思想</h2>
      
<p><strong>代码的零库存管理</strong></p>
<ul>
<li>代码越早push出去，用户能越早用到，快就是商业价值；</li>
<li>用户越早用到就越早反馈，团队越早得到反馈，好坏都是有价值的输入；</li>
<li>用户不反馈，说明我们做了用户不想要的东西（通过用例跟踪）或者marketing没做好，能帮助产品市场人员调整策略；</li>
<li>代码库存越是积压，就越得不到生产检验，积压越多，代码间交叉感染的概率越大，下个release的复杂度和风险越高；</li>
<li>代码库存越多，workflow的包袱越重，管理成本越大，说敏捷越可笑。</li>
</ul>

        <h2 id="持续集成"   >
          <a href="#持续集成" class="heading-link"><i class="fas fa-link"></i></a>持续集成</h2>
      
<p>首先是 <span class="exturl"><a class="exturl__link"   href="https://en.wikipedia.org/wiki/Continuous_integration"  target="_blank" rel="noopener">WiKi</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 给出的定义：</p>
<blockquote>
<p><strong>continuous integration</strong> (<strong>CI</strong>) is the practice of merging all developer working copies to a shared mainline several times a day.</p>
</blockquote>
<p><strong>持续集成</strong> 的含义为：频繁的（一天多次的）将所有开发者的工作合并到主干上。</p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913201803.png"  alt="" />
      </p>
<p>从图例上来看持续集成的流程就十分清晰了：</p>
<ul>
<li>开发人员提交代码到 <strong>Source Repository</strong> （源代码仓库），并通过 git hook 等</li>
<li>触发 <strong>CI Server</strong>（持续集成服务器）的相关功能。执行 <strong>编译 -&gt; 测试 -&gt; 输出结果</strong> 的流程，</li>
<li>向开发人员反馈结果的 <strong>report</strong></li>
</ul>
<p>可以看出，持续集成的 <strong>核心</strong> 在于 <strong>确保新增的代码能够与原先代码正确的集成</strong>。与后续要介绍的持续交付以及持续部署，其最主要的差别也就在于其目标不同。</p>
<p>不过持续集成的流程还存在一定的异议：上图所示的流程为 <strong>Build -&gt; Test</strong>，在阮老师的教程里头是 <strong>Test -&gt; Build</strong>。不过，持续集成本身只不过是一种软件工程的方法或者策略，其并不规定具体的实现。在实际的应用中，还是需要结合具体的开发语言或者工具来定。</p>
<p><strong>持续集成的优势</strong></p>
<p>和我们一直在使用的 <strong>阶段集成</strong>（完成一个阶段的开发后执行代码的集成） 相比， <strong>持续集成</strong> 的策略能够为我们带来哪些好处呢？</p>
<ul>
<li><strong>易于定位错误</strong>：每一次的代码集成都需要执行相关的测试工作，持续集成频繁的集成次数天然的将复杂的代码逻辑切割为了小块，也就使得每一次测试中遇到的错误能够更加容易的被定位；</li>
<li><strong>易于控制开发流程</strong>：更为细致的工作提交也就意味着更容易判断当前的工作进度，这对于管理者规划开发流程而言提供了一个有效的参考，同时也为开发人员省下了汇报工作的时间；</li>
<li><strong>易于CodeReview</strong>：对于大块工作的切分自然也有助于做 CodeReview；</li>
<li><strong>易于减少不必要的工作</strong>：build 以及 test 过程的自动化可以为你节约一大票的时间，从而投入到有价值的工作中去。</li>
</ul>

        <h2 id="持续交付"   >
          <a href="#持续交付" class="heading-link"><i class="fas fa-link"></i></a>持续交付</h2>
      
<p>同样，以 <span class="exturl"><a class="exturl__link"   href="https://en.wikipedia.org/wiki/Continuous_delivery"  target="_blank" rel="noopener">WiKi</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 的定义开头：</p>
<blockquote>
<p><strong>Continuous delivery</strong> (<strong>CD</strong> or <strong>CDE</strong>) is a software engineering approach in which teams produce software in short cycles, ensuring that the software can be reliably released at any time and, when releasing the software, doing so manually.</p>
</blockquote>
<p><strong>持续交付</strong> 指的是：一种能够使得软件在较短的循环中可靠的发布的软件工程方法。</p>
<p>与持续集成相比，持续交付的侧重点在于 <strong>交付</strong>，其核心对象不在于代码，而在于可交付的产物。由于持续集成仅仅针对于新旧代码的集成过程执行了一定的测试，其变动到持续交付后还需要一些额外的流程。</p>
<p>仍然以图例说明：</p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202454.png"  alt="" />
      </p>
<p>可以看到，与 <strong>持续集成</strong> 相比较，<strong>持续交付</strong> 添加了 <strong>Test -&gt; Staging -&gt; Production</strong> 的流程，也就是为新增的代码添加了一个保证： <strong>确保新增的代码在生产环境中是可用的</strong> 。<br />
在这一增加的流程中，<strong>Test</strong> 环节不仅仅包含基本的单元测试，还需要延伸到更为复杂的功能测试以及集成测试等。在这里，<strong>Staging</strong> 指的是 <strong>类生产环境</strong> ，其尽可能的对真实的网络拓扑、数据库数据以及硬件设备等资源进行模拟，从而为测试人员反馈代码在生成环境中的可能表现。流程中每一个环节的执行结果都会对开发人员进行反馈，每一个出现的错误都会导致版本的回滚。当测试完毕确认无误之后，将由相关人员对其进行 <strong>手动部署到生产环境</strong>。</p>

        <h2 id="持续部署"   >
          <a href="#持续部署" class="heading-link"><i class="fas fa-link"></i></a>持续部署</h2>
      
<p>照惯例 <span class="exturl"><a class="exturl__link"   href="https://en.wikipedia.org/wiki/Continuous_deployment"  target="_blank" rel="noopener">Wiki</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 开头：</p>
<blockquote>
<p>Continuous deployment (CD) is a software engineering approach in which software functionalities are delivered frequently through automated deployments.</p>
</blockquote>
<p><strong>持续部署</strong> 意味着：通过自动化部署的手段将软件功能频繁的进行交付。<br />
与持续交付以及持续集成相比，持续部署强调了通过 <strong>automated deployment</strong> 的手段，对新的软件功能进行集成。</p>
<p>上图例说明：</p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202655.png"  alt="" />
      </p>
<p>可以看到，同 <strong>持续交付</strong> 相比 <strong>持续集成</strong> 的区别体现在对 <strong>Production</strong> 的自动化。从开发人员提交代码到编译、测试、部署的全流程不需要人工的干预，完全通过自动化的方式执行。这一策略加快了代码提交到功能上线的速度，保证新的功能能够第一时间部署到生产环境并被使用。</p>

        <h2 id="devops"   >
          <a href="#devops" class="heading-link"><i class="fas fa-link"></i></a>DevOps</h2>
      
<p>介绍完了持续集成、持续交付和持续部署三大件，接下来在讲讲 <strong>DevOps</strong>。与三大件不同，<strong>DevOps</strong> 更偏向于一种对于文化氛围的构建。</p>
<p>还是搬出 <span class="exturl"><a class="exturl__link"   href="https://en.wikipedia.org/wiki/DevOps"  target="_blank" rel="noopener">Wiki</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>：</p>
<blockquote>
<p>DevOps (a clipped compound of “development” and “operations”) is a software development methodology that combines software development (Dev) with information technology operations (Ops). The goal of DevOps is to shorten the systems development life cycle while also delivering features, fixes, and updates frequently in close alignment with business objectives.</p>
</blockquote>
<p><strong>DevOps</strong> 一词本身是对于 <strong>development</strong> 以及 <strong>operation</strong> 两个词的混合，其目的在于缩短系统开发的生命周期，在这过程中发布特性、修复bug以及更新均被紧密的结合。<br />
听起来似乎有点玄乎，可以这样理解：<strong>DevOps</strong> 也即是促使开发人员与运维人员之间相互协作的文化。<br />
DevOps 的概念似乎与持续交付的概念有些类似，两者均旨在促进开发与运维之间的协作，但是实际上两者差别很大：DevOps 更偏向于一种文化的构建，在 DevOps 文化指导下，团队中将包含了具有不同技能的人员（开发、测试等），并通过自动化测试与发布的手段，更快、更高质量的生产软件。</p>
<p>以图为例：</p>
<p><strong>传统开发和运维</strong></p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202822.png"  alt="" />
      </p>
<p><strong>使用DevOps之后</strong></p>
<p>
        <img   class="lazyload lazyload-gif"
          src="/images/loading.svg" data-src="https://gitee.com/lienhui68/picStore/raw/master/null/20200913202828.png"  alt="" />
      </p>
<p>在传统的团队组织方式中，开发人员与运维人员之间是割裂开的，软件开发流程被分割为多个独立环节，分别由不同的人员执行。这使得软件开发过程中需要付出高昂的沟通成本，层层手动的流程将大量的时间耗费在了重复的劳动中。<br />
在 <strong>DevOps</strong> 的指导下，不同技能的人员处在同个团队中，为了一个共同的软件开发目标而工作，更好的协同工作与自动化的手段能够优化整个 <strong>Code -&gt; Build -&gt; Test -&gt; Release -&gt; Operate -&gt; Code</strong> 的循环。这一理念看起来很美，用图画来说明就构成了一个和谐友好的大圈，不过在实际应用中也许会遇到不少问题，例如不同技能人员之间相互沟通的额外开销、团队组织形式改变后为管理所带来的困难等等。这些问题大概等到真正将 DevOps 在开发过程中开展来才能做解答了。</p>

        <h2 id="小结"   >
          <a href="#小结" class="heading-link"><i class="fas fa-link"></i></a>小结</h2>
      
<ul>
<li><strong>持续集成</strong> 是三者中最简单的，同时也是开销最低的。由于不需要类生产环境的配合，测试环境也可以仅支持单元测试的执行，使得持续集成的实现是最为便宜的。考虑到现实开发过程的种种限制，向资源与成本做妥协，舍弃持续交付或者持续部署这样看起来很美的方法，退而转向持续集成也是很合理的选择；</li>
<li><strong>持续交付</strong> 面向开发初期或者软件稳定性或者安全性要求较高的领域，新增代码提交、编译、测试等一系列环节均可以通过自动化工具完成，很好的节约了人力资源的同时，还对新增代码的功能进行了有效的保障。在手动执行的部署环节，还可以添加在执行完毕标准测试之外的可能需求，以保证发布功能的可靠；</li>
<li><strong>持续部署</strong> 面向稳定的发布上线后的功能更新。自动的，无需人工干预的部署可以保证新增功能第一时间被发布到生产环境中，确保其尽快的被用户所使用。其与持续交付相比，就在于其功能可靠性与功能及时性的侧重不同。</li>
</ul>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="http://lienhui68.gitee.io">lienhui68</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="http://lienhui68.gitee.io/2020/%E5%B7%A5%E4%BD%9C/300_DevOps/uncategorized/DevOps/">http://lienhui68.gitee.io/2020/%E5%B7%A5%E4%BD%9C/300_DevOps/uncategorized/DevOps/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-reward reward"><div class="reward-button">请我喝杯咖啡~</div><div class="reward-qrcode"><span class="reward-qrcode-alipay"><img class="reward-qrcode-alipay__img" src="/assets/6.jpeg"><div class="reward-qrcode-alipay__text">支付宝打赏</div></span><span class="reward-qrcode-wechat"><img class="reward-qrcode-wechat__img" src="/assets/5.jpeg"><div class="reward-qrcode-wechat__text">微信打赏</div></span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2020/%E5%B7%A5%E4%BD%9C/300_DevOps/linux/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%BF%AB%E6%8D%B7%E9%94%AE/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">linux命令行快捷键</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2020/%E5%B7%A5%E4%BD%9C/300_DevOps/uncategorized/git/"><span class="paginator-prev__text">git</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div><div class="comments" id="comments"><div id="valine-container"></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#devops简介"><span class="toc-number">1.</span> <span class="toc-text">
          DevOps简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#devops工具链"><span class="toc-number">2.</span> <span class="toc-text">
          DevOps工具链</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#devops架构"><span class="toc-number">3.</span> <span class="toc-text">
          DevOps架构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#devops环境部署"><span class="toc-number">4.</span> <span class="toc-text">
          Devops环境部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装jira项目管理"><span class="toc-number">4.1.</span> <span class="toc-text">
          安装JIRA（项目管理）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-gitlab代码管理"><span class="toc-number">4.2.</span> <span class="toc-text">
          安装 GitLab(代码管理)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-docker容器服务"><span class="toc-number">4.3.</span> <span class="toc-text">
          安装 Docker（容器服务）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-rancher容器调度"><span class="toc-number">4.4.</span> <span class="toc-text">
          安装 Rancher（容器调度）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-harbor镜像仓库"><span class="toc-number">4.5.</span> <span class="toc-text">
          安装 Harbor（镜像仓库）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-clair镜像扫描"><span class="toc-number">4.6.</span> <span class="toc-text">
          安装 Clair（镜像扫描）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#持续集成-持续交付-持续部署"><span class="toc-number">5.</span> <span class="toc-text">
          持续集成、持续交付、持续部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#指导思想"><span class="toc-number">5.1.</span> <span class="toc-text">
          指导思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#持续集成"><span class="toc-number">5.2.</span> <span class="toc-text">
          持续集成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#持续交付"><span class="toc-number">5.3.</span> <span class="toc-text">
          持续交付</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#持续部署"><span class="toc-number">5.4.</span> <span class="toc-text">
          持续部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#devops"><span class="toc-number">5.5.</span> <span class="toc-text">
          DevOps</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">5.6.</span> <span class="toc-text">
          小结</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/assets/3.png" alt="avatar"></div><p class="sidebar-ov-author__text">人类的悲欢并不相通</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/lienhui68" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://www.facebook.com/profile.php?id=100009351871465" target="_blank" rel="noopener" data-popover="Facebook" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-facebook"></i></span></a><a class="sidebar-ov-social-item" href="https://www.zhihu.com/people/lienhui68" target="_blank" rel="noopener" data-popover="知乎" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">知</span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">335</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">47</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">51</div><div class="sidebar-ov-state-item__name">标签</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2020</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>lienhui68 All Rights Reserved</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">访问人数</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">浏览总量</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div><div>我抓不住世间的美好，只好装作万事顺遂的样子</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章（支持多关键词，请用空格分隔）"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.min.js"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // 将 XML 转为 JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // 搜索对象（标题、内容）的权重，影响显示顺序
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // 根据空白字符分隔关键字
        var keywords = searchText.split(/[\s]+/);
        // 搜索结果
        var matchPosts = [];

        // 有多个关键字时，将原文字整个保存下来
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // 防止未输入字符时搜索
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // 没有标题的文章使用预设的 i18n 变量代替
            var title = (data.title && data.title.trim()) || '[ 文章无标题 ]';
            var titleLower = title && title.toLowerCase();
            // 删除 HTML 标签 和 所有空白字符
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // 删除重复的 /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // 标题中匹配到的关键词
            var titleHitSlice = [];
            // 内容中匹配到的关键词
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * 获取匹配的关键词的索引
              * @param {String} keyword 要匹配的关键字
              * @param {String} text 原文字
              * @param {Boolean} caseSensitive 是否区分大小写
              * @param {Number} weight 匹配对象的权重。权重大的优先显示
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // 每次匹配的开始索引
                var index = -1;     // 匹配到的索引值
                var result = [];    // 匹配结果

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // 索引位置相同的关键词，保留长度较长的
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // 按照匹配文字的索引的递增顺序排序
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * 给文本中匹配到的关键词添加标记，从而进行高亮显示
              * @param {String} text 原文本
              * @param {Array} hitSlice 匹配项的索引信息
              * @param {Number} start 开始索引
              * @param {Number} end 结束索引
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // 文章总的搜索权重
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // 标记匹配关键词后的标题
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // 标记匹配关键词后的内容
              var postContent;
              // 显示内容的长度
              var SHOW_WORD_LENGTH = 200;
              // 命中关键词前的字符显示长度
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // 截取匹配的第一个字符，前后共 200 个字符来显示
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // 未匹配到内容，直接截取前 200 个字符来显示
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // 按权重递增的顺序排序，使权重大的优先显示
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);</script><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="https://cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function loadValine () {
  var GUEST_INFO = ['nick', 'mail', 'link'];
  var guest_info = 'nick,mail,link';

  guest_info = guest_info.split(',').filter(function(item) {
    return GUEST_INFO.indexOf(item) > -1;
  });
  new Valine({
    el: '#valine-container',
    appId: 'iTixDcNjX1XLIDnENLxM9F1E-gzGzoHsz',
    appKey: 'hKBKmiysmFkqF2ik6yCcEATU',
    notify: true,
    verify: true,
    placeholder: '欢迎评论',
    avatar: 'mp',
    meta: guest_info,
    pageSize: '10' || 10,
    visitor: false,
    recordIP: false,
    lang: '' || 'zh-cn',
    path: window.location.pathname
  });
}

if (false) {
  loadValine();
} else {
  window.addEventListener('DOMContentLoaded', loadValine, false);
}</script><script src="/js/utils.js?v=2.0.1"></script><script src="/js/stun-boot.js?v=2.0.1"></script><script src="/js/scroll.js?v=2.0.1"></script><script src="/js/header.js?v=2.0.1"></script><script src="/js/sidebar.js?v=2.0.1"></script></body></html>